const express = require('express');
const router = express.Router();
const { protecteRoute, authorizeRole } = require('../middleware/protectedRoute');
const {
    placeOrder,
    getSingleOrderDetail,
    myOrder,
    getAllOrders,
    updateOrderStatus,
    deleteOrder,
    updateOrderPaymentStatus,
    midtransWebhook
} = require('../controllers/orderController');

router.route('/orders/place').post(protecteRoute, placeOrder);
router.route('/orders/:id').get(protecteRoute, getSingleOrderDetail);
router.route('/me/orders').get(protecteRoute, myOrder);
router.route('/orders').get(protecteRoute, authorizeRole("admin"), getAllOrders);
router.route('/orders/update/status/:id').put(protecteRoute, authorizeRole("admin"), updateOrderStatus);
router.route('/orders/delete/:id').delete(protecteRoute, authorizeRole("admin"), deleteOrder);
router.route('/orders/pay/:id').put(protecteRoute, updateOrderPaymentStatus);
router.post('/midtrans-notify', midtransWebhook);

module.exports = router;